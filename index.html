<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>PNP</title><script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script><script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script><style>:root{--bg:#000;--panel:#1a1a1a;--text:#eee;--acc:#bb86fc}*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}body{margin:0;background:var(--bg);color:var(--text);font-family:sans-serif;height:100vh;display:flex;flex-direction:column;overflow:hidden}#login-view{position:fixed;inset:0;z-index:5000;background:var(--bg);display:flex;flex-direction:column;justify-content:center;align-items:center}.auth-box{width:300px;padding:30px;background:var(--panel);border-radius:12px;border:1px solid #333;text-align:center}.btn-google{width:100%;padding:15px;background:#4285F4;color:white;border:none;border-radius:6px;font-size:16px;font-weight:bold;margin-top:15px;cursor:pointer;transition:background .1s}.btn-google:active{background:#ff0;color:#000;transform:scale(.98)}#app-view{display:none;width:100%;height:100%;flex-direction:column}.canvas-area{height:75vh;width:100%;display:flex;justify-content:center;align-items:center;background:radial-gradient(circle,#222,#000);position:relative}.canvas-wrapper{width:100%;height:100%;display:flex;justify-content:center;align-items:center;padding:10px}canvas{background:#fff;max-width:95%;max-height:95%;box-shadow:0 10px 40px #000;border:1px solid #333}.tools-area{height:25vh;background:var(--panel);border-top:1px solid #333;display:flex;align-items:center;overflow-x:auto;padding:0 15px 3% 15px;gap:20px}.tool-btn{width:50px;height:50px;background:#333;border-radius:50%;display:flex;justify-content:center;align-items:center;font-size:22px;border:1px solid #444;color:#fff;margin-bottom:5px;flex-shrink:0}.tool-group{display:flex;flex-direction:column;align-items:center;min-width:60px}.tool-label{font-size:10px;color:#aaa}.hidden-controls{display:none}#modal{position:fixed;inset:0;background:rgba(0,0,0,.9);z-index:6000;display:none;justify-content:center;align-items:center}.modal-box{background:var(--panel);padding:20px;border-radius:10px;width:90%;max-width:320px;text-align:center;border:1px solid #444}</style></head><body><div class="hidden-controls"><input type="file" id="fInput"><input type="number" id="tW" value="100"><input type="number" id="tH" value="90"><input type="text" id="sW"><input type="text" id="sH"><input type="number" id="gap" value="2"><select id="shp"><option value="rect">Rect</option><option value="circle">Circle</option><option value="arch-top">Arch Top</option><option value="arch-bottom">Arch Bottom</option></select><input type="number" id="archDepth" value="10"><input type="range" id="zoom" min="0.1" max="3" step="0.1" value="1"><input type="checkbox" id="mirror"><select id="fitMode"><option value="cover">Cover</option><option value="stretch">Stretch</option><option value="contain">Contain</option></select><input type="color" id="clr" value="#ffffff"></div><div id="login-view"><div class="auth-box"><h2 style="color:#fff;margin:0">PNP</h2><p style="color:#666;font-size:12px">Pixel N Preview</p><button class="btn-google" id="btnLogin" onclick="appLogin()"><span>üìÇ</span> Sign in with Google</button><div id="login-status" style="margin-top:15px;font-size:12px;color:#ff0;min-height:20px"></div></div></div><div id="app-view"><div class="canvas-area"><div style="position:absolute;top:10px;left:10px;color:#fff;font-size:12px;background:rgba(0,0,0,.5);padding:5px 10px;border-radius:15px" id="userName">Guest</div><div style="position:absolute;top:10px;right:10px;color:#000;font-size:12px;background:#bb86fc;padding:5px 10px;border-radius:15px;font-weight:bold" id="creditDisplay">...</div><div class="canvas-wrapper"><canvas id="cvs"></canvas></div></div><div class="tools-area"><div class="tool-group" onclick="handleUploadClick()"><div class="tool-btn" style="background:#fff;color:#000">üìÇ</div><span class="tool-label">Upload</span></div><div class="tool-group" onclick="promptVal('tW','Width')"><div class="tool-btn">‚ÜîÔ∏è</div><span class="tool-label">Width</span></div><div class="tool-group" onclick="promptVal('tH','Height')"><div class="tool-btn">‚ÜïÔ∏è</div><span class="tool-label">Height</span></div><div class="tool-group" onclick="cycleZoom()"><div class="tool-btn">üîç</div><span class="tool-label" id="lbl-zoom">1.0x</span></div><div class="tool-group" onclick="cycleFit()"><div class="tool-btn">üñºÔ∏è</div><span class="tool-label" id="lbl-fit">Cover</span></div><div class="tool-group" onclick="toggleMirror()"><div class="tool-btn">ü™û</div><span class="tool-label">Flip</span></div><div class="tool-group" onclick="cycleShape()"><div class="tool-btn">‚¨ú</div><span class="tool-label" id="lbl-shape">Rect</span></div><div class="tool-group" id="btn-arch-depth" style="display:none" onclick="promptVal('archDepth','Arch Depth (inches)')"><div class="tool-btn">üìê</div><span class="tool-label">Arch<br>Depth</span></div><div class="tool-group"><div class="tool-btn" style="position:relative"><input type="color" oninput="updateColor(this.value)" style="position:absolute;opacity:0;width:100%;height:100%"><div style="pointer-events:none">üé®</div></div><span class="tool-label">Color</span></div><div class="tool-group" id="btn-lock" onclick="unlockPro()"><div class="tool-btn" style="border-color:var(--acc);color:var(--acc)">üîì</div><span class="tool-label" style="color:var(--acc)" disabled>Unlock</span></div><div id="pro-grp" style="display:none;gap:15px"><div class="tool-group" onclick="promptVal('sW','Split W')"><div class="tool-btn" style="border-color:var(--acc);color:var(--acc)">‚úÇÔ∏è</div><span class="tool-label" style="color:var(--acc)">Split W</span></div><div class="tool-group" onclick="promptVal('sH','Split H')"><div class="tool-btn" style="border-color:var(--acc);color:var(--acc)">‚ûó</div><span class="tool-label" style="color:var(--acc)">Split H</span></div><div class="tool-group" onclick="promptVal('gap','Gap')"><div class="tool-btn" style="border-color:var(--acc);color:var(--acc)">Gap</div><span class="tool-label" style="color:var(--acc)">Gap</span></div></div><div class="tool-group" onclick="downloadCanvas()"><div class="tool-btn">‚¨áÔ∏è</div><span class="tool-label">Save</span></div><div class="tool-group" onclick="auth.signOut()"><div class="tool-btn" style="background:#500">X</div><span class="tool-label">Exit</span></div></div></div><div id="modal"><div class="modal-box"><h3 style="color:#fff">Confirm Image</h3><img id="modal-img" style="max-width:100%;height:150px;object-fit:contain;background:#000"><p style="color:#aaa">Cost: <b style="color:var(--acc)">4 Credits</b></p><button onclick="closeModal(!0)" style="width:100%;padding:10px;background:var(--acc);border:none;border-radius:5px;font-weight:bold">Confirm</button><button onclick="closeModal(!1)" style="width:100%;padding:10px;background:#333;color:#fff;border:none;border-radius:5px;margin-top:5px">Cancel</button></div></div><script>
    /* --- DISABLE INSPECT & RIGHT CLICK --- */
    document.addEventListener('contextmenu', function(e) { e.preventDefault(); });
    document.onkeydown = function(e) {
        if(e.keyCode == 123) { return false; } // Block F12
        if(e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) { return false; } // Block Ctrl+Shift+I
        if(e.ctrlKey && e.shiftKey && e.keyCode == 'C'.charCodeAt(0)) { return false; } // Block Ctrl+Shift+C
        if(e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) { return false; } // Block Ctrl+Shift+J
        if(e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) { return false; } // Block Ctrl+U
    };
  
  /* SECURITY SHIELD (SCRAMBLED) */
(function(_0x1a){var _0x2b=['pixelnpreview.com','mohammedsingapur.github.io','includes','hostname','location','body','innerHTML','<div style="display:flex;justify-content:center;align-items:center;height:100vh;background:#000;color:red;font-family:sans-serif;font-weight:bold;text-align:center;"><h1>‚õî ACCESS DENIED</h1><p>Invalid Domain</p></div>','userAgent','test','/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i','innerWidth','<div style="display:flex;justify-content:center;align-items:center;height:100vh;background:#111;color:#fff;font-family:sans-serif;text-align:center;"><div style="font-size:50px;">üì±</div><h2>Mobile Only</h2><p>Please open on phone.</p></div>'];var _0x3c=function(_0x4d){return _0x2b[_0x4d]};var _0x5e=window[_0x3c(4)][_0x3c(3)];var _0x6f=[_0x3c(0),_0x3c(1)];var _0x7g=!_0x6f.some(function(_0x8h){return _0x5e[_0x3c(2)](_0x8h)});if(_0x7g){document[_0x3c(5)][_0x3c(6)]=_0x3c(7);throw new Error('X');}var _0x9i=new RegExp(_0x3c(10)).test(navigator[_0x3c(8)])||window[_0x3c(11)]<900;if(!_0x9i){document[_0x3c(5)][_0x3c(6)]=_0x3c(12);throw new Error('Y');}})();
/* APP LOGIC (MINIFIED) */
var firebaseConfig={apiKey:"AIzaSyBup3s_Z3nVZU-O5da0owglWaFXh5Fpfdg",authDomain:"customise-previews.firebaseapp.com",projectId:"customise-previews",storageBucket:"customise-previews.firebasestorage.app",messagingSenderId:"1073406972228",appId:"1:1073406972228:web:71ee5db786b2fe2af40711"};var db,auth,currentUser,currentImg,tempSrc,uploadedFileName;var imgState={x:0,y:0,zoom:1.0,isDragging:!1,lastX:0,lastY:0};var hiddenBlocks={};try{if(typeof firebase==='undefined')throw new Error("Firebase SDK not loaded!");firebase.initializeApp(firebaseConfig);db=firebase.firestore();auth=firebase.auth()}catch(e){alert("App Error: "+e.message)}function appLogin(){var b=document.getElementById('btnLogin'),m=document.getElementById('login-msg');b.innerText="Connecting...";if(m)m.innerText="";if(!auth){alert("Firebase not loaded");return}auth.setPersistence(firebase.auth.Auth.Persistence.LOCAL).then(function(){var p=new firebase.auth.GoogleAuthProvider();return auth.signInWithPopup(p)}).catch(function(e){b.innerText="üìÇ Sign in with Google";if(m)m.innerText=e.message;if(e.code==='auth/popup-blocked'){alert("‚ö†Ô∏è Popup Blocked")}else{alert("Login Failed: "+e.message)}})}if(auth){auth.getRedirectResult().catch(function(e){console.error(e)});auth.onAuthStateChanged(function(u){if(u){currentUser=u;document.getElementById('login-view').style.display='none';document.getElementById('app-view').style.display='flex';document.getElementById('userName').innerText=u.email;db.collection('users').doc(u.uid).onSnapshot(function(d){if(!d.exists)db.collection('users').doc(u.uid).set({email:u.email,credits:10});else document.getElementById('creditDisplay').innerText=(d.data().credits||0)+" Cr"});setTimeout(draw,500)}else{document.getElementById('login-view').style.display='flex';document.getElementById('app-view').style.display='none'}})}function promptVal(i,t){var v=prompt(t,document.getElementById(i).value);if(v!==null){document.getElementById(i).value=v;draw()}}function cycleZoom(){var e=document.getElementById('zoom'),v=parseFloat(e.value);v=(v>=3)?0.5:v+0.5;e.value=v;document.getElementById('lbl-zoom').innerText=v+"x";draw()}function cycleFit(){var e=document.getElementById('fitMode'),o=['cover','stretch','contain'];e.value=o[(o.indexOf(e.value)+1)%3];document.getElementById('lbl-fit').innerText=e.value;draw()}function toggleMirror(){var e=document.getElementById('mirror');e.checked=!e.checked;draw()}function cycleShape(){var e=document.getElementById('shp'),o=['rect','circle','arch-top','arch-bottom'];e.value=o[(o.indexOf(e.value)+1)%4];document.getElementById('lbl-shape').innerText=e.value.replace('-',' ');draw()}function updateColor(v){document.getElementById('clr').value=v;draw()}function handleUploadClick(){document.getElementById('fInput').click();document.getElementById('btn-lock').style.display='flex';document.getElementById('pro-grp').style.display='none';document.getElementById('sW').value='';document.getElementById('sH').value='';hiddenBlocks={}}function unlockPro(){if(!currentUser)return;var b=document.getElementById('btn-lock');b.querySelector('.tool-label').innerText="...";var r=db.collection('users').doc(currentUser.uid);db.runTransaction(function(t){return t.get(r).then(function(d){var c=d.data().credits||0;if(c<2)throw "Need 2 Credits";t.update(r,{credits:c-2})})}).then(function(){b.style.display='none';document.getElementById('pro-grp').style.display='flex';document.getElementById('gap').value='2';draw()}).catch(function(e){alert(e);b.querySelector('.tool-label').innerText="Unlock"})}var cvs=document.getElementById('cvs');function getV(i){return parseFloat(document.getElementById(i).value)||0}document.getElementById('fInput').addEventListener('change',function(e){if(e.target.files[0]){var f=e.target.files[0];uploadedFileName=f.name.split('.')[0];var r=new FileReader();r.onload=function(ev){tempSrc=ev.target.result;document.getElementById('modal-img').src=tempSrc;document.getElementById('modal').style.display='flex'};r.readAsDataURL(f);e.target.value=''}});function closeModal(p){document.getElementById('modal').style.display='none';if(p&&tempSrc){var r=db.collection('users').doc(currentUser.uid);db.runTransaction(function(t){return t.get(r).then(function(d){var c=d.data().credits||0;if(c<4)throw "Low Balance";t.update(r,{credits:c-4})})}).then(function(){var i=new Image();i.onload=function(){currentImg=i;imgState={x:0,y:0,zoom:1.0};document.getElementById('zoom').value=1.0;draw()};i.src=tempSrc}).catch(function(e){alert(e)})}}function startDrag(e){imgState.isDragging=!0;imgState.lastX=e.touches?e.touches[0].clientX:e.clientX;imgState.lastY=e.touches?e.touches[0].clientY:e.clientY}function doDrag(e){if(!imgState.isDragging)return;e.preventDefault();var cx=e.touches?e.touches[0].clientX:e.clientX,cy=e.touches?e.touches[0].clientY:e.clientY;imgState.x+=(cx-imgState.lastX);imgState.y+=(cy-imgState.lastY);imgState.lastX=cx;imgState.lastY=cy;draw()}function stopDrag(){imgState.isDragging=!1}cvs.addEventListener('mousedown',startDrag);window.addEventListener('mousemove',doDrag);window.addEventListener('mouseup',stopDrag);cvs.addEventListener('touchstart',startDrag);window.addEventListener('touchmove',doDrag);window.addEventListener('touchend',stopDrag);function draw(){var ctx=cvs.getContext('2d');var tW=getV('tW')||100,tH=getV('tH')||90,gap=getV('gap')||0,aDepth=getV('archDepth')||10;var zoom=parseFloat(document.getElementById('zoom').value)||1.0;var shp=document.getElementById('shp').value;var dB=document.getElementById('btn-arch-depth');if(dB)dB.style.display=shp.includes('arch')?'flex':'none';var sW=document.getElementById('sW').value,sH=document.getElementById('sH').value;var cols=sW?sW.split(',').map(Number):[tW],rows=sH?sH.split(',').map(Number):[tH];var vW=cols.reduce((a,b)=>a+b,0)+(cols.length-1)*gap;var vH=rows.reduce((a,b)=>a+b,0)+(rows.length-1)*gap;var HD=1500;cvs.width=HD;cvs.height=HD;var pad=100,safeW=HD-2*pad,safeH=HD-2*pad;var PPI=Math.min(safeW/vW,safeH/vH);var sX=pad+(safeW-vW*PPI)/2,sY=pad+(safeH-vH*PPI)/2;var iP=null;if(currentImg){var pW=tW*PPI,pH=tH*PPI;var wCX=sX+(vW*PPI)/2,wCY=sY+(vH*PPI)/2;var fit=document.getElementById('fitMode').value;var dW,dH,iR=currentImg.width/currentImg.height,tR=pW/pH;if(fit==='stretch'){dW=pW;dH=pH}else if(fit==='contain'){if(iR>tR){dW=pW;dH=pW/iR}else{dH=pH;dW=pH*iR}}else{if(iR>tR){dH=pH;dW=pH*iR}else{dW=pW;dH=pW/iR}}iP={gx:wCX,gy:wCY,w:dW,h:dH}}ctx.fillStyle="white";ctx.fillRect(0,0,HD,HD);var cY=sY;rows.forEach(function(h,rI){var cX=sX;var rS=shp;if(shp==='arch-top'&&rI!==0)rS='rect';if(shp==='arch-bottom'&&rI!==rows.length-1)rS='rect';cols.forEach(function(w,cI){var dW=w*PPI,dH=h*PPI;ctx.save();ctx.beginPath();trace(ctx,cX,cY,dW,dH,rS,PPI,aDepth);ctx.clip();ctx.fillStyle=document.getElementById('clr').value;ctx.fill();if(iP&&!hiddenBlocks[rI+'-'+cI]){ctx.save();ctx.translate(iP.gx+imgState.x,iP.gy+imgState.y);ctx.scale(zoom,zoom);if(document.getElementById('mirror').checked)ctx.scale(-1,1);ctx.drawImage(currentImg,-iP.w/2,-iP.h/2,iP.w,iP.h);ctx.restore()}ctx.restore();ctx.strokeStyle="#333";ctx.lineWidth=4;ctx.beginPath();trace(ctx,cX,cY,dW,dH,rS,PPI,aDepth);ctx.stroke();var fs=60;ctx.fillStyle="#333";ctx.font="bold "+fs+"px sans-serif";ctx.textAlign="center";ctx.fillText(w+'"',cX+dW/2,cY+dH+70);ctx.save();ctx.translate(cX-30,cY+dH/2);ctx.rotate(-Math.PI/2);ctx.fillText(h+'"',0,0);ctx.restore();cX+=dW+gap*PPI});cY+=h*PPI+gap*PPI})}function trace(c,x,y,w,h,t,p,dp){var d=Math.min(h,(dp||10)*p);if(t==='rect')c.rect(x,y,w,h);else if(t==='circle')c.ellipse(x+w/2,y+h/2,w/2,h/2,0,0,2*Math.PI);else if(t==='arch-top'){c.moveTo(x,y+h);c.lineTo(x,y+d);c.bezierCurveTo(x,y,x+w,y,x+w,y+d);c.lineTo(x+w,y+h)}else if(t==='arch-bottom'){c.moveTo(x,y);c.lineTo(x+w,y);c.lineTo(x+w,y+h-d);c.bezierCurveTo(x+w,y+h,x,y+h,x,y+h-d);c.lineTo(x,y)}c.closePath()}function downloadCanvas(){var a=document.createElement('a');a.download='pnp-'+(uploadedFileName||'design')+'.png';a.href=cvs.toDataURL();a.click()}cvs.addEventListener('dblclick',function(e){var rect=cvs.getBoundingClientRect();var x=(e.clientX-rect.left)*(cvs.width/rect.width);var y=(e.clientY-rect.top)*(cvs.height/rect.height);var tW=getV('tW')||100,tH=getV('tH')||90,gap=getV('gap')||0;var sW=document.getElementById('sW').value,sH=document.getElementById('sH').value;var cols=sW?sW.split(',').map(Number):[tW],rows=sH?sH.split(',').map(Number):[tH];var HD=1500;var vW=cols.reduce((a,b)=>a+b,0)+(cols.length-1)*gap;var vH=rows.reduce((a,b)=>a+b,0)+(rows.length-1)*gap;var pad=100,safeW=HD-2*pad,safeH=HD-2*pad;var PPI=Math.min(safeW/vW,safeH/vH);var sX=pad+(safeW-vW*PPI)/2,sY=pad+(safeH-vH*PPI)/2;var cY=sY;for(var rI=0;rI<rows.length;rI++){var h=rows[rI],cX=sX;for(var cI=0;cI<cols.length;cI++){var w=cols[cI],dW=w*PPI,dH=h*PPI;if(x>=cX&&x<=cX+dW&&y>=cY&&y<=cY+dH){var k=rI+'-'+cI;if(hiddenBlocks[k])delete hiddenBlocks[k];else hiddenBlocks[k]=!0;draw();return}cX+=dW+gap*PPI}cY+=h*PPI+gap*PPI}});
</script></body></html>
